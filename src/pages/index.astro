---
import Layout from '../layouts/Layout.astro';
---

<Layout title="FirstRep - Start Your First Rep Here">
	<main class="max-w-4xl mx-auto px-6 py-20 text-center">
		<h1 class="text-6xl font-black mb-6 tracking-tight">
			First<span class="text-indigo-500">Rep</span>
		</h1>
		<p class="text-2xl text-gray-400 mb-12">
			"Start your first rep here."
		</p>
		
		<div class="bg-gray-900/50 border border-gray-800 p-8 rounded-2xl mb-12">
			<h2 class="text-2xl font-bold mb-4">Personalized Fitness Questionnaire</h2>
			<p class="text-gray-400 mb-8">Answer these questions to get your custom program.</p>
			
			<form id="quiz-form" class="space-y-6 text-left max-w-md mx-auto">
				<div>
					<label class="block text-sm font-medium mb-2">Biological Sex</label>
					<select id="sex" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 outline-none">
						<option value="male">Male</option>
						<option value="female">Female</option>
					</select>
				</div>
				<div>
					<label class="block text-sm font-medium mb-2">Age Range</label>
					<select id="age" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 outline-none">
						<option value="18-40">18-40</option>
						<option value="40-65">40-65</option>
						<option value="65+">65+</option>
					</select>
				</div>
				<div>
					<label class="block text-sm font-medium mb-2">Fitness Goal</label>
					<select id="goal" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:ring-2 focus:ring-indigo-500 outline-none">
						<option value="Build Muscle">Build Muscle</option>
						<option value="Lose Weight">Lose Weight</option>
						<option value="Strength / Powerlifting">Strength / Powerlifting</option>
						<option value="General Fitness">General Fitness</option>
					</select>
				</div>
				<button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-lg transition">
					Get My Program
				</button>
			</form>
		</div>

		<!-- Program Display Area -->
		<div id="program-display" class="hidden text-left bg-gray-900 border border-indigo-500/30 p-8 rounded-2xl mb-12">
			<h2 id="program-name" class="text-3xl font-black mb-2 text-indigo-400"></h2>
			<p id="program-schedule" class="text-gray-400 mb-4 italic"></p>
			<div class="bg-indigo-500/10 border border-indigo-500/20 p-4 rounded-lg mb-6">
				<p class="text-sm font-bold text-indigo-300 uppercase tracking-widest mb-1">AI Reasoning</p>
				<p id="program-reasoning" class="text-sm text-gray-300"></p>
			</div>
			
			<div id="workout-container" class="space-y-8">
				<!-- Full program days will be injected here -->
			</div>
			
			<button onclick="window.print()" class="mt-8 w-full md:w-auto bg-gray-800 hover:bg-gray-700 text-white px-6 py-2 rounded-lg text-sm font-bold transition">
				Download / Print Plan
			</button>
		</div>

		<script>
			import programsData from '../data/programs.json';

			const form = document.getElementById('quiz-form');
			const display = document.getElementById('program-display');

			form?.addEventListener('submit', (e) => {
				e.preventDefault();
				
				const sex = document.getElementById('sex').value;
				const age = document.getElementById('age').value;
				const goal = document.getElementById('goal').value;

				// Find best match in our static library
				const match = programsData.baseline_templates.find(t => 
					t.target.sex === sex && 
					t.target.age_range === age && 
					t.target.goal === goal
				) || programsData.baseline_templates[0]; 

				// Update UI
				document.getElementById('program-name').innerText = match.name;
				document.getElementById('program-schedule').innerText = match.schedule;
				document.getElementById('program-reasoning').innerText = match.reasoning;
				
				const container = document.getElementById('workout-container');
				
				// Generate full 4-week structure based on days per week
				// For this version, we'll show the detailed Day 1, Day 2, etc. templates
				// and notes on how to progress them over 4 weeks.
				
				const workoutDays = [
					{ label: 'Day 1: Primary Lift Focus', exercises: match.workout },
					{ label: 'Day 2: Accessory & Recovery', exercises: [...match.workout].reverse() }, // Placeholder for variety
					{ label: 'Day 3: Strength & Conditioning', exercises: match.workout }
				];

				container.innerHTML = workoutDays.map(day => `
					<div class="space-y-4">
						<h3 class="text-xl font-bold border-b border-gray-800 pb-2 text-indigo-200">${day.label}</h3>
						<div class="space-y-3">
							${day.exercises.map(ex => `
								<div class="flex justify-between items-center bg-gray-800/50 p-3 rounded-lg border border-gray-700/50">
									<div>
										<p class="font-bold text-gray-100">${ex.exercise}</p>
										<p class="text-xs text-gray-500">Rest: ${ex.rest}</p>
									</div>
									<div class="text-right">
										<p class="text-indigo-400 font-mono font-bold">${ex.sets} x ${ex.reps}</p>
									</div>
								</div>
							`).join('')}
						</div>
					</div>
				`).join('') + `
					<div class="mt-8 p-6 bg-indigo-950/30 border border-indigo-500/20 rounded-xl">
						<h4 class="text-lg font-bold mb-2 text-indigo-300">4-Week Progression Guide</h4>
						<ul class="text-sm text-gray-400 space-y-2 list-disc pl-5">
							<li><strong class="text-gray-200">Week 1:</strong> Find your "Working Weight" (tough but good form).</li>
							<li><strong class="text-gray-200">Week 2:</strong> Add 2.5 - 5 lbs to your primary lifts.</li>
							<li><strong class="text-gray-200">Week 3:</strong> Attempt 1 extra rep on your final set of each exercise.</li>
							<li><strong class="text-gray-200">Week 4 (Deload):</strong> Use 70% of your Week 3 weight to allow recovery.</li>
						</ul>
					</div>
				`;

				display.classList.remove('hidden');
				display.scrollIntoView({ behavior: 'smooth' });
			});
		</script>

		<div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-left">
			<div class="p-6 border border-gray-800 rounded-xl bg-gray-900/30">
				<h3 class="font-bold mb-2">Macro Tracking</h3>
				<p class="text-sm text-gray-500">Combine nutrition with training in one place.</p>
			</div>
			<div class="p-6 border border-gray-800 rounded-xl bg-gray-900/30">
				<h3 class="font-bold mb-2">Whoop Sync</h3>
				<p class="text-sm text-gray-500">Coming soon: leverage your recovery data.</p>
			</div>
			<div class="p-6 border border-gray-800 rounded-xl bg-gray-900/30">
				<h3 class="font-bold mb-2">Cheap & Simple</h3>
				<p class="text-sm text-gray-500">Just $5/month for AI-personalized coaching.</p>
			</div>
		</div>
	</main>
</Layout>
